<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="2318">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="2318">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2318">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>2318</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">2318</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/23/hadoop-install-pseudo-distributed/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="2318">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="2318">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/23/hadoop-install-pseudo-distributed/" itemprop="url">Hadoop Pseudo-Distributed Setup</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-23T12:23:23+08:00">
                2017-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Hadoop-Pseudo-Distributed-Setup"><a href="#Hadoop-Pseudo-Distributed-Setup" class="headerlink" title="Hadoop Pseudo-Distributed Setup"></a>Hadoop Pseudo-Distributed Setup</h2><h3 id="偽分布式模式-Pseudo-Distributed-Mode"><a href="#偽分布式模式-Pseudo-Distributed-Mode" class="headerlink" title="偽分布式模式(Pseudo-Distributed Mode)"></a>偽分布式模式(Pseudo-Distributed Mode)</h3><ul>
<li>在單個集群上運行Hadoop</li>
<li>所有的Hadoop daemon皆運行在不同的Java process</li>
<li>在單機模式上增加了程式調適功能，並允許檢查以下狀態:<ul>
<li>記憶體使用情況</li>
<li>HDFS的輸出/輸入</li>
<li>與其他daemon的交互情況，如namenode，datanode，secondarynamenode，jobtracer，tasktrace</li>
</ul>
</li>
</ul>
<h3 id="部署流程"><a href="#部署流程" class="headerlink" title="部署流程"></a>部署流程</h3><h4 id="基本訊息"><a href="#基本訊息" class="headerlink" title="基本訊息"></a>基本訊息</h4><ul>
<li>OS: CentOS 6.5 64bit</li>
<li>Hadoop: 2.8.1</li>
<li>JDK: 8u144</li>
</ul>
<h4 id="新增Hadoop-user"><a href="#新增Hadoop-user" class="headerlink" title="新增Hadoop user"></a>新增Hadoop user</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 ~]<span class="comment"># useradd hadoop</span></div><div class="line">[root@hadoop-01 ~]<span class="comment"># vi /etc/sudoers</span></div><div class="line"><span class="comment">## Allow root to run any commands anywhere </span></div><div class="line">root    ALL=(ALL)       ALL</div><div class="line">hadoop ALL=(ALL)       ALL    <span class="comment">## 新增此行，賦予sudo權限給hadoop user</span></div></pre></td></tr></table></figure>
<h4 id="設置Hadoop目錄"><a href="#設置Hadoop目錄" class="headerlink" title="設置Hadoop目錄"></a>設置Hadoop目錄</h4><ul>
<li>Hadoop壓縮包來源可以是:<ul>
<li>透過Hadoop source code自行編譯</li>
<li><a href="http://hadoop.apache.org/releases.html" title="Hadoop releases" target="_blank" rel="external">Hadoop官網下載</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 ~]<span class="comment"># cd /opt/software/</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># ls</span></div><div class="line">hadoop-2.8.1.tar.gz  <span class="comment">## 已下載的hadoop 2.8.1</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># tar -xzvf hadoop-2.8.1.tar.gz</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># ls</span></div><div class="line">hadoop-2.8.1</div><div class="line">hadoop-2.8.1.tar.gz</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="建立Hadoop目錄軟連結"><a href="#建立Hadoop目錄軟連結" class="headerlink" title="建立Hadoop目錄軟連結"></a>建立Hadoop目錄軟連結</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 software]<span class="comment"># ln -s hadoop-2.8.1 hadoop</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># chown hadoop:hadoop hadoop-2.8.1</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># chown -R hadoop:hadoop hadoop-2.8.1/*</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># chown hadoop:hadoop hadoop</span></div><div class="line">[root@hadoop-01 software]<span class="comment"># cd hadoop</span></div><div class="line">[root@hadoop-01 hadoop]<span class="comment"># ll</span></div><div class="line">total 156</div><div class="line">drwxr-xr-x. 2 hadoop hadoop  4096 Aug 21 02:13 bin</div><div class="line">drwxr-xr-x. 3 hadoop hadoop  4096 Aug 21 02:13 etc</div><div class="line">drwxr-xr-x. 2 hadoop hadoop  4096 Aug 21 02:13 include</div><div class="line">drwxr-xr-x. 3 hadoop hadoop  4096 Aug 21 02:13 lib</div><div class="line">drwxr-xr-x. 2 hadoop hadoop  4096 Aug 21 02:13 libexec</div><div class="line">-rw-r--r--. 1 hadoop hadoop 99253 Aug 21 02:13 LICENSE.txt</div><div class="line">drwxrwxr-x. 2 hadoop hadoop  4096 Aug 21 22:50 logs</div><div class="line">-rw-r--r--. 1 hadoop hadoop 15915 Aug 21 02:13 NOTICE.txt</div><div class="line">-rw-r--r--. 1 hadoop hadoop  1366 Aug 21 02:13 README.txt</div><div class="line">drwxr-xr-x. 2 hadoop hadoop  4096 Aug 21 02:13 sbin</div><div class="line">drwxr-xr-x. 3 hadoop hadoop  4096 Aug 21 02:13 share</div></pre></td></tr></table></figure>
<h4 id="設置環境變量"><a href="#設置環境變量" class="headerlink" title="設置環境變量"></a>設置環境變量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 hadoop]<span class="comment"># vi /etc/profile</span></div><div class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/software/hadoop</div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$PATH</span></div><div class="line">[root@hadoop-01 hadoop]<span class="comment"># source /etc/profile</span></div></pre></td></tr></table></figure>
<h4 id="確認ssh-service狀態"><a href="#確認ssh-service狀態" class="headerlink" title="確認ssh service狀態"></a>確認ssh service狀態</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 hadoop]<span class="comment"># service sshd status</span></div><div class="line">openssh-daemon (pid  2086) is running...</div><div class="line"><span class="comment">## 若非上述這種狀態，需進行排查</span></div></pre></td></tr></table></figure>
<h4 id="配置Hadoop-user與ssh信任關係"><a href="#配置Hadoop-user與ssh信任關係" class="headerlink" title="配置Hadoop user與ssh信任關係"></a>配置Hadoop user與ssh信任關係</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-01 hadoop]<span class="comment"># su - hadoop</span></div><div class="line">[hadoop@hadoop-01 ~]$ <span class="built_in">cd</span> /opt/software/hadoop</div><div class="line">[hadoop@hadoop-01 hadoop]$ ssh-keygen -t rsa -P <span class="string">''</span> -f ~/.ssh/id_rsa</div><div class="line">Generating public/private rsa key pair.</div><div class="line">Created directory <span class="string">'/home/hadoop/.ssh'</span>.</div><div class="line">Your identification has been saved <span class="keyword">in</span> /home/hadoop/.ssh/id_rsa.</div><div class="line">Your public key has been saved <span class="keyword">in</span> /home/hadoop/.ssh/id_rsa.pub.</div><div class="line">The key fingerprint is:</div><div class="line">f2:49:22:bd:fb:7b:ca:d1:1a:ef:81:45:74:d0:dc:28 hadoop@hadoop-01</div><div class="line">...</div><div class="line">[hadoop@hadoop-01 hadoop]$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</div><div class="line">[hadoop@hadoop-01 hadoop]$ chmod 0600 ~/.ssh/authorized_keys</div><div class="line">[hadoop@hadoop-01 hadoop]$ ssh hadoop001 date</div><div class="line">...</div><div class="line">Mon Aug 21 22:10:12 CST 2017</div><div class="line">[hadoop@hadoop-01 hadoop]$ ssh hadoop-01 date</div><div class="line">Mon Aug 21 22:10:22 CST 2017</div></pre></td></tr></table></figure>
<h4 id="配置Hadoop-Pseudo-Distributed文件"><a href="#配置Hadoop-Pseudo-Distributed文件" class="headerlink" title="配置Hadoop Pseudo-Distributed文件"></a>配置Hadoop Pseudo-Distributed文件</h4><p><a href="http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Pseudo-Distributed_Operation" title="Hadoop Pseudo-Distribute" target="_blank" rel="external">Hadoop官方建議配置</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[hadoop@hadoop-01 hadoop]$ vi etc/hadoop/core-site.xml</div><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;property&gt;</div><div class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</div><div class="line">        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</div><div class="line">    &lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div><div class="line"></div><div class="line">[hadoop@hadoop-01 hadoop]$ vi etc/hadoop/hdfs-site.xml</div><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;property&gt;</div><div class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</div><div class="line">        &lt;value&gt;1&lt;/value&gt;</div><div class="line">    &lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure></p>
<h4 id="HDFS格式化與啟動Hadoop"><a href="#HDFS格式化與啟動Hadoop" class="headerlink" title="HDFS格式化與啟動Hadoop"></a>HDFS格式化與啟動Hadoop</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[hadoop@hadoop-01 hadoop]$  vi etc/hadoop/hadoop-env.sh</div><div class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_144 <span class="comment">## 將hadoop-env.sh內的JAVA_HOME指定到jdk位置</span></div><div class="line">[hadoop@hadoop-01 hadoop]$ <span class="built_in">which</span> hdfs</div><div class="line">/opt/software/hadoop/bin/hdfs</div><div class="line">[hadoop@hadoop-01 hadoop]$ hdfs namenode -format</div><div class="line">...</div><div class="line">17/08/21 22:22:37 INFO namenode.FSImage: Allocated new BlockPoolId: BP-42224246-192.168.16.91-1503325357194</div><div class="line">17/08/21 22:22:37 INFO common.Storage: Storage directory /tmp/hadoop-hadoop/dfs/name has been successfully formatted.  <span class="comment">## 格式化成功訊息</span></div><div class="line">...</div><div class="line">[hadoop@hadoop-01 hadoop]$ <span class="built_in">which</span> start-dfs.sh</div><div class="line">/opt/software/hadoop/sbin/start-dfs.sh</div><div class="line">[hadoop@hadoop-01 hadoop]$ start-dfs.sh</div><div class="line">[hadoop@hadoop-01 hadoop]$ jps <span class="comment">## 使用jps確認hadoop相關process狀態</span></div><div class="line">11586 NameNode</div><div class="line">11718 DataNode</div><div class="line">11882 SecondaryNameNode</div><div class="line">11996 Jps</div><div class="line"><span class="comment">## 也可以使用瀏覽器訪問http://localhost:50070，確認Hadoop啟動狀態</span></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/03/nlp-gram/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="2318">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="2318">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/03/nlp-gram/" itemprop="url">NLP N-gram</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-03T00:38:06+08:00">
                2017-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="N-gram-Language-Model"><a href="#N-gram-Language-Model" class="headerlink" title="N-gram Language Model"></a>N-gram Language Model</h2><h3 id="定義"><a href="#定義" class="headerlink" title="定義"></a>定義</h3><p>為一種統計語言模型(Statistical Language Model)，統計語言模型定義:<br><img src="/2017/07/03/nlp-gram/img_1.svg" width="500"></p>
<p>而N-gram又稱為N元模型，N-gram是指一段語句中包含N個Token，譬如abcde，則2-gram依次為:<br>ab, bc, cd, de<br><br></p>
<h3 id="馬可夫假設-Markov-chain"><a href="#馬可夫假設-Markov-chain" class="headerlink" title="馬可夫假設(Markov chain)"></a>馬可夫假設(Markov chain)</h3><p>根據鏈式法則將統計語言模型展開後可得:<br><img src="/2017/07/03/nlp-gram/img_2.svg" width="500"></p>
<p>這裡利用馬可夫假設進行，縮減參數空間。馬可夫假設的概念為，任一個詞出現的機率，只與前幾個詞有關西。<br>N-gram模型的N指出要取前幾個詞(包含自己)來計算。N越大，則模型越準確，但也越複雜，且計算量也大。<br>最常使用的為Bigram，N取≥4的情况的情況較少。<br>常用的N-gram模型的縮減後為:<br>1-gram(Unigram):<br><img src="/2017/07/03/nlp-gram/img_3.svg" width="300"><br>2-gram(Bigram):<br><img src="/2017/07/03/nlp-gram/img_4.svg" width="400"><br>3-gram(Trigram):<br><img src="/2017/07/03/nlp-gram/img_5.svg" width="500"></p>
<p>學習過程中，利用最大似然法將上述算式的參數求出，並追求將訓練樣本概率的最大值。<br><br></p>
<h3 id="平滑方法-Smoothing"><a href="#平滑方法-Smoothing" class="headerlink" title="平滑方法(Smoothing)"></a>平滑方法(Smoothing)</h3><p>對於語言處理，被證實數據稀疏(Data Sparseness)的存在，故提出數據平滑(Data Smoothing)技術來解決。<br>數據稀疏指出在測試過程中的語料，沒有在訓練階段出現過。數據平滑技術是增強語言模型的重要手段，而且其效果與訓練集的規模有關，當規模越小，則數據平滑的效果越好，反之，則不顯著，甚至可以忽略。</p>
<p>目前已知效果最好的數據平滑演算法為Modified kneser-Ney Smoothing:</p>
<img src="/2017/07/03/nlp-gram/img_6.svg" width="500">
<p>D1、D2、和D3分別用來對應於 Unigram、Bigram 與 Trigram<br><img src="/2017/07/03/nlp-gram/img_7.svg" width="100"><br><img src="/2017/07/03/nlp-gram/img_8.svg" width="150"><br><img src="/2017/07/03/nlp-gram/img_9.svg" width="150"><br><img src="/2017/07/03/nlp-gram/img_10.svg" width="150"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/rf-basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="2318">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="2318">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/rf-basic/" itemprop="url">RF Basic</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-28T00:20:02+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Random-Forsest"><a href="#Random-Forsest" class="headerlink" title="Random Forsest"></a>Random Forsest</h2><h2 id="定義"><a href="#定義" class="headerlink" title="定義"></a>定義</h2><p>RF為Bagging的擴展變形。RF以決策樹為基學習器，並在決策樹訓練時，引入隨機屬性選擇。</p>
<h2 id="產生基學習器"><a href="#產生基學習器" class="headerlink" title="產生基學習器"></a>產生基學習器</h2><p>建立每一顆決策樹皆包含行採樣、列採樣與完全分裂三個步驟:</p>
<ol>
<li><p>行採樣: 目的是挑選進行訓練的數據。採用有放回的方式，及為採樣得到的樣本集中，可能會有重複的樣本。假設，輸入N個樣本，那麼採樣的樣本也為N個。在訓練時，每一顆樹輸入樣本都不是全部的樣本，使得相對不容易over-fitting。</p>
</li>
<li><p>列採樣: 目的是挑選進行訓練的特徵，從M個特徵中，挑m個(m &lt;&lt; M)。</p>
</li>
<li><p>完全分裂: 使用完全分裂的方式對採樣後的數據建立決策樹，這樣決策樹的某一個葉子節點要麼是無法繼續分裂，不然就是裡面的樣本全屬一同一個分類。</p>
</li>
</ol>
<p>與其他決策樹算法不同的是，這裡不進行剪枝，因為前兩個隨機採樣的過程保證了隨機性，就算不進行剪枝，也不會出現over-fitting</p>
<h2 id="Bagging"><a href="#Bagging" class="headerlink" title="Bagging"></a>Bagging</h2><p>為一種並行式集成學習方法，基於自助採樣法(bootstrap sampling)，在有N個樣本的數據集中，隨機挑選一個樣本，然後將樣本放回，下次隨機挑選時，仍有機會挑中相同的樣本。根據公式推算，約有63.2%的樣本會被用來進行訓練。<br>透過上述步驟，可採樣出T個包含N個樣本的子數據集，對每個子數據集進行訓練，則會得到T個基學習器，再將這些基學習器進行結合。<br>進行結合時，Bagging通常對分類問題採用簡單投票法，對回歸問題採用簡單平均法。</p>
<h2 id="優點"><a href="#優點" class="headerlink" title="優點"></a>優點</h2><ul>
<li>在很多數據集上，相對其他算法有著很大的優勢</li>
<li>能夠處理很高維度(feature很多)的數據，並且不用做特徵選擇</li>
<li>在訓練完後，它能給出哪些feature比較重要</li>
<li>在創建隨機森林時，對 generlization error使用的是無偏估計</li>
<li>訓練速度快</li>
<li>容易做成並行化方法</li>
<li>實現比較簡單</li>
</ul>
<h2 id="缺點"><a href="#缺點" class="headerlink" title="缺點"></a>缺點</h2><ul>
<li>模型規模較大</li>
</ul>
<h2 id="Python-示例"><a href="#Python-示例" class="headerlink" title="Python 示例"></a>Python 示例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score</div><div class="line"></div><div class="line"><span class="comment"># Type of data is DataFrame</span></div><div class="line">X = data.iloc[:, data.columns != <span class="string">"label"</span>].values</div><div class="line">y = data.iloc[:, data.columns == <span class="string">"label"</span>].values</div><div class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.3</span>, random_state=<span class="number">0</span>)</div><div class="line">classifier = RandomForestClassifier(random_state=<span class="number">0</span>)</div><div class="line">classifier.fit(X_train, y_train.ravel())</div><div class="line"></div><div class="line">y_pred = classifier.predict(X_test)</div><div class="line"><span class="keyword">print</span> <span class="string">"accuracy: %f"</span> %accuracy_score(y_test, y_pred)</div><div class="line"><span class="keyword">print</span> <span class="string">"precision: %f"</span> %precision_score(y_test, y_pred, average=<span class="string">"macro"</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"recall: %f"</span> %recall_score(y_test, y_pred, average=<span class="string">"macro"</span>)</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/26/svm_basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="2318">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="2318">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/26/svm_basic/" itemprop="url">SVM basic</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-26T13:33:41+08:00">
                2017-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="SVM-Support-Vector-Machines"><a href="#SVM-Support-Vector-Machines" class="headerlink" title="SVM(Support Vector Machines)"></a>SVM(Support Vector Machines)</h2><h3 id="運作原理"><a href="#運作原理" class="headerlink" title="運作原理"></a>運作原理</h3><p>使用分隔超平面(separating hyperplane)，將線性可分的數據分隔開來；在超平面同側的資料，屬於同一個類別。</p>
<h3 id="如何挑選分隔超平面"><a href="#如何挑選分隔超平面" class="headerlink" title="如何挑選分隔超平面"></a>如何挑選分隔超平面</h3><p>找到離超平面最近的點，並且讓它們離分隔面越遠越好。支援向量(support vector)及為離超平面最近的那些點；而支援向量到超平面的距離稱為間隔(margin)。在挑選超平面時，追求一個擁有最大間隔的超平面，保證在處理未知資料時的分類或回歸效果最佳。</p>
<h3 id="演算法參數"><a href="#演算法參數" class="headerlink" title="演算法參數"></a>演算法參數</h3><ul>
<li>鬆弛變量(slack variable)<ul>
<li>許多時候數據並非能切分的很乾淨，引入鬆弛變量後，允許有些數據點可以被切分至錯誤的一側。</li>
</ul>
</li>
<li>RBF kernel(Radial basis function kernel)<ul>
<li>gamma: 影響每個支持向量對應的高斯的作用範圍。當gamma越大，則支援向量越少。而支援向量的數量影響訓練與預測的速度。</li>
</ul>
</li>
</ul>
<h3 id="核函數-kernel"><a href="#核函數-kernel" class="headerlink" title="核函數(kernel)"></a>核函數(kernel)</h3><p>在數據集非線性可分的情況下，可以透過核函數將數據集原本所在的特徵空間，映射至另一個更高維度的特徵空間中，在高維空間中，透過SVM解決線性可分的問題。目前應用較廣的核函數為線性核與高斯核。</p>
<h3 id="優點"><a href="#優點" class="headerlink" title="優點"></a>優點</h3><ul>
<li>泛化錯誤率低</li>
<li>容易解释</li>
<li>計算複雜度較低</li>
</ul>
<h3 id="缺點"><a href="#缺點" class="headerlink" title="缺點"></a>缺點</h3><ul>
<li>對優化參數、核函數以及核函數中的參數較敏感</li>
<li>解決多分類問題時，需用額外的方式進行擴展</li>
<li>對噪聲敏感</li>
</ul>
<h3 id="Python-示例"><a href="#Python-示例" class="headerlink" title="Python 示例"></a>Python 示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score</div><div class="line"></div><div class="line"><span class="comment"># Type of data is DataFrame</span></div><div class="line">X = data.iloc[:, data.columns != <span class="string">"label"</span>].values</div><div class="line">y = data.iloc[:, data.columns == <span class="string">"label"</span>].values</div><div class="line"></div><div class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.3</span>, random_state=<span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="comment"># Using the linear kernel to build the SVC classifier</span></div><div class="line"><span class="comment"># classifier = SVC(C=1, kernel='linear', random_state=0)</span></div><div class="line"></div><div class="line"><span class="comment"># Using the RBF kernel to build the SVC classifier</span></div><div class="line">classifier = SVC(C=<span class="number">1</span>, kernel=<span class="string">'rbf'</span>, random_state=<span class="number">0</span>)</div><div class="line">classifier.fit(X_train, y_train.ravel())</div><div class="line"></div><div class="line">y_pred = classifier.predict(X_test)</div><div class="line"><span class="keyword">print</span> <span class="string">"accuracy: %f"</span> %accuracy_score(y_test, y_pred)</div><div class="line"><span class="keyword">print</span> <span class="string">"precision: %f"</span> %precision_score(y_test, y_pred, average=<span class="string">"macro"</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"recall: %f"</span> %recall_score(y_test, y_pred, average=<span class="string">"macro"</span>)</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/12/verify_a_signature_with_certificate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="2318">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="2318">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/12/verify_a_signature_with_certificate/" itemprop="url">Verify a signature with certificate</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-12T15:24:52+08:00">
                2017-02-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="所需檔案建立"><a href="#所需檔案建立" class="headerlink" title="所需檔案建立"></a>所需檔案建立</h3><h4 id="建立CA基礎設施"><a href="#建立CA基礎設施" class="headerlink" title="建立CA基礎設施"></a>建立CA基礎設施</h4><ol>
<li>建立CA基礎設施，步驟可參考<a href="https://jamielinux.com/docs/openssl-certificate-authority/introduction.html" target="_blank" rel="external">openssl-certificate-authority</a></li>
<li>透過以上步驟可獲得Certificate與Private key<ul>
<li>Certificate位置: /root/ca/intermediate/certs/www.example.com.cert.pem</li>
<li>Private key位置: /root/ca/intermediate/private/www.example.com.key.pem</li>
</ul>
</li>
</ol>
<p><br></p>
<h4 id="建立Signature"><a href="#建立Signature" class="headerlink" title="建立Signature"></a>建立Signature</h4><ol>
<li>可以使用前述所產生的Certificate與Private key，或已經擁有的Certificate與Private key產生Signature，只要Certificate與Private key兩者是有對應關西的。</li>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> <span class="string">"hello signature"</span> &gt; test.txt  </div><div class="line">$ openssl dgst -sha256 -sign /root/ca/intermediate/private/www.example.com.key.pem -out test.txt.sha256 test.txt</div></pre></td></tr></table></figure>
</li>
</ol>
<p><br></p>
<h4 id="使用Certificate驗證Signature"><a href="#使用Certificate驗證Signature" class="headerlink" title="使用Certificate驗證Signature"></a>使用Certificate驗證Signature</h4><ol>
<li>Certificate無法直接驗證Signature，需先透過指令從Certificate提取出Public key，再用Pubilc key驗證Signature是否合法 <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ openssl x509 -pubkey -noout -<span class="keyword">in</span> /root/ca/intermediate/certs/www.example.com.cert.pem &gt; www.example.com.pubkey.pem</div><div class="line">$ openssl dgst -verify www.example.com.pubkey.pem -signature test.txt.sha256 test.txt</div><div class="line">Verified OK</div></pre></td></tr></table></figure>
</li>
</ol>
<p><br></p>
<h3 id="使用C-實做"><a href="#使用C-實做" class="headerlink" title="使用C++實做"></a>使用C++實做</h3><h4 id="C-example-code"><a href="#C-example-code" class="headerlink" title="C++ example code"></a>C++ example code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* ------------------------------------------------------------ *</span></div><div class="line"><span class="comment"> * file:        verifySignature.cpp                             *</span></div><div class="line"><span class="comment"> * purpose:     Example code for OpenSSL signature validation   *</span></div><div class="line"><span class="comment"> *                                                              *</span></div><div class="line"><span class="comment"> * g++ -o verifySignature verifySignature.cpp -lssl -lcrypto    *</span></div><div class="line"><span class="comment"> * ------------------------------------------------------------ */</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/bio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/err.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/pem.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/x509.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/x509_vfy.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/crypto.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">verifySignature</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> certFile, <span class="built_in">std</span>::<span class="built_in">string</span> sigFile, <span class="built_in">std</span>::<span class="built_in">string</span> sourceFile)</span> </span>&#123;</div><div class="line">    BIO *certFileBio = <span class="literal">NULL</span>, *sigFileBio = <span class="literal">NULL</span>, *sourceFileBio = <span class="literal">NULL</span>, </div><div class="line">        *digestBio = <span class="literal">NULL</span>, *messageDigestBio = <span class="literal">NULL</span>, *bio_err = <span class="literal">NULL</span>;   </div><div class="line">    EVP_PKEY *sigPublickey = <span class="literal">NULL</span>;</div><div class="line">    X509 *cert = <span class="literal">NULL</span>;</div><div class="line">    EVP_MD_CTX *mdCtx = <span class="literal">NULL</span>;</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">size_t</span> sigLen = <span class="number">0</span>;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *sigBuf = <span class="literal">NULL</span>, *digestBuf = <span class="literal">NULL</span>;</div><div class="line">    <span class="keyword">bool</span> ret = <span class="literal">false</span>, readFileFailed = <span class="literal">false</span>;</div><div class="line"></div><div class="line">    <span class="keyword">do</span> &#123;</div><div class="line">        <span class="comment">// Create the Input/Output BIO's.</span></div><div class="line">        bio_err = BIO_new_fp(<span class="built_in">stdout</span>, BIO_NOCLOSE);</div><div class="line">        <span class="keyword">if</span> (!bio_err) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Fail to create the output BIO's \n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        certFileBio = BIO_new(BIO_s_file());</div><div class="line">        <span class="keyword">if</span> (!certFileBio) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Fail to create the certificate file BIO's \n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Load the certification from file (PEM).</span></div><div class="line">        <span class="keyword">if</span> (!BIO_read_filename(certFileBio, certFile.c_str())) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!(cert = PEM_read_bio_X509(certFileBio, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>))) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error loading cert into memory \n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Load public key from certification.</span></div><div class="line">        sigPublickey = X509_get_pubkey(cert);</div><div class="line">        <span class="keyword">if</span> (!sigPublickey) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Fail to get public key form certificate \n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Create the message digest BIO.</span></div><div class="line">        messageDigestBio = BIO_new(BIO_f_md());</div><div class="line">        <span class="keyword">if</span> (!messageDigestBio) &#123;</div><div class="line">            IO_printf(bio_err, <span class="string">"Fail to create the message digest BIO's \n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Get digest BIOs context.</span></div><div class="line">        <span class="keyword">if</span> (!BIO_get_md_ctx(messageDigestBio, &amp;mdCtx)) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error getting context\n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// Sets up verification context to use digest.</span></div><div class="line">        <span class="keyword">if</span> (!EVP_DigestVerifyInit(mdCtx, <span class="literal">NULL</span>, EVP_sha256(), <span class="literal">NULL</span>, sigPublickey)) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error setting context\n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// Read signature file into buffer.</span></div><div class="line">        sigFileBio = BIO_new_file(sigFile.c_str(), <span class="string">"rb"</span>);</div><div class="line">        <span class="keyword">if</span> (!sigFileBio) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error opening signature file %s\n"</span>, sigFile);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        sigLen = EVP_PKEY_size(sigPublickey);</div><div class="line">        sigBuf = (<span class="keyword">unsigned</span> <span class="keyword">char</span>*) OPENSSL_malloc(sigLen);</div><div class="line">        <span class="keyword">if</span> (sigBuf == <span class="literal">NULL</span>) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Could not allocate %d bytes for %s\n"</span>,</div><div class="line">                    sigLen, <span class="string">"signature buffer"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        sigLen = BIO_read(sigFileBio, sigBuf, sigLen);</div><div class="line">        <span class="keyword">if</span> (sigLen &lt;= <span class="number">0</span>) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error reading signature file %s\n"</span>, sigFile);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;      </div><div class="line"></div><div class="line">        <span class="comment">// Append the source file to digest BIO.</span></div><div class="line">        sourceFileBio = BIO_new(BIO_s_file());</div><div class="line">        <span class="keyword">if</span> (!sourceFileBio) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!BIO_read_filename(sourceFileBio, sourceFile.c_str())) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        digestBio = BIO_push(messageDigestBio, sourceFileBio);</div><div class="line"></div><div class="line">        <span class="comment">// Move data pointer position to the end.</span></div><div class="line">        digestBuf = (<span class="keyword">unsigned</span> <span class="keyword">char</span>*) OPENSSL_malloc(BUFSIZE);</div><div class="line">        <span class="keyword">if</span> (digestBuf == <span class="literal">NULL</span>) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Could not allocate %d bytes for %s\n"</span>,</div><div class="line">                    BUFSIZE, <span class="string">"I/O buffer"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (;;) &#123;</div><div class="line">            i = BIO_read(digestBio, (<span class="keyword">char</span> *)digestBuf, BUFSIZE);</div><div class="line">            <span class="keyword">if</span> (i &lt; <span class="number">0</span>) &#123;cert/VortexModel_v3.bin.sha256</div><div class="line">                BIO_printf(bio_err, <span class="string">"Read Error\n"</span>);</div><div class="line">                ERR_print_errors(bio_err);</div><div class="line">                readFileFailed = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (readFileFailed) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// Load the digest BIOs context into EVP_MD_CTX</span></div><div class="line">        BIO_get_md_ctx(digestBio, &amp;mdCtx);</div><div class="line">        i = EVP_DigestVerifyFinal(mdCtx, sigBuf, sigLen);</div><div class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Verified OK\n"</span>);</div><div class="line">            ret = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Verification Failure\n"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            BIO_printf(bio_err, <span class="string">"Error Verifying Data\n"</span>);</div><div class="line">            ERR_print_errors(bio_err);</div><div class="line">        &#125;        </div><div class="line">    &#125; <span class="keyword">while</span>(<span class="number">0</span>);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (bio_err) &#123;</div><div class="line">        BIO_free_all(bio_err);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (certFileBio) &#123;</div><div class="line">        BIO_free_all(certFileBio);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (cert) &#123;</div><div class="line">        X509_free(cert);</div><div class="line">    &#125;    </div><div class="line">    <span class="keyword">if</span> (sigPublickey) &#123;</div><div class="line">        EVP_PKEY_free(sigPublickey);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (messageDigestBio) &#123;</div><div class="line">        BIO_free(messageDigestBio);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (sigFileBio) &#123;</div><div class="line">        BIO_free(sigFileBio);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (sigBuf) &#123;</div><div class="line">        OPENSSL_free(sigBuf);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (digestBuf) &#123;</div><div class="line">        OPENSSL_free(digestBuf);</div><div class="line">    &#125;    </div><div class="line">    <span class="keyword">if</span> (sourceFileBio) &#123;</div><div class="line">        BIO_free(sourceFileBio);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</div><div class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">certFile</span><span class="params">(<span class="string">"/root/ca/intermediate/certs/www.example.com.cert.pem"</span>)</span></span>;</div><div class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">sigFile</span><span class="params">(<span class="string">"test.txt.sha256"</span>)</span></span>;</div><div class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">sourceFile</span><span class="params">(<span class="string">"test.txt"</span>)</span></span>;</div><div class="line">    </div><div class="line">    verifySignature(certFile, sigFile, sourceFile);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Compiling-the-Code"><a href="#Compiling-the-Code" class="headerlink" title="Compiling the Code"></a>Compiling the Code</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ gcc -o verifySignature verifySignature.c -lssl -lcrypto</div><div class="line">$ ./verifySignature</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">2318</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">Tags</span>
                
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">2318</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
